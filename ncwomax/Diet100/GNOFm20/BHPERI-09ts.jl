using DoNOF

mol = """
0 1
   C          0.82811623     -0.21159071      1.20475236
   S          1.44229845     -1.34965561      0.00000000
   C         -1.24908468     -0.55021654      0.70215925
   C          0.92063196      1.10965997      0.68648128
   C          0.82811623     -0.21159071     -1.20475236
   C         -1.24908468     -0.55021654     -0.70215925
   C          0.92063196      1.10965997     -0.68648128
   H          0.95673695     -0.45976415      2.25014901
   H         -1.31253032     -1.49358802      1.23028606
   H         -1.67759043      0.29044163      1.23347846
   H          0.81257107      1.98988563      1.30728665
   H          0.95673695     -0.45976415     -2.25014901
   H         -1.31253032     -1.49358802     -1.23028606
   H         -1.67759043      0.29044163     -1.23347846
   H          0.81257107      1.98988563     -1.30728665
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "BHPERI-09ts"

p.ipnof = 8
p.ista = 1
p.h_cut = 0.02 * sqrt(2)

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
