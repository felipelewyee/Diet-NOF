using DoNOF

mol = """
0 1
   C         -2.43681269     -1.25725682     -0.09421289
   C         -1.15737109     -0.96562800      0.19258173
   O         -0.39395614     -1.77722266      1.00332819
   C         -0.46377694      0.19875599     -0.31955551
   C          0.79751305      0.61100262     -0.05235439
   N          1.66280742      0.02727098      0.85029008
   C          1.34720750      1.84702641     -0.69749263
   H         -3.00707953     -0.60357727     -0.73192314
   H         -2.91760443     -2.14020809      0.30122074
   H         -0.94441928     -2.51239771      1.28671532
   H         -1.04320628      0.81068644     -0.99343606
   H          1.42599800     -0.89990239      1.15805441
   H          2.64015659      0.17766289      0.67388767
   H          0.62336674      2.29307545     -1.37153758
   H          2.24721116      1.61133270     -1.26738928
   H          1.61996592      2.57937947      0.06182332
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "TAUT15-3d"

p.ipnof = 5

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
