using DoNOF

mol = """
0 1
N          0.321087926381   -1.232408890589    0.281255316214
H          0.575755867360   -2.184472578711    0.507176843546
C         -1.053690860617   -0.961404041955    0.216892385495
O         -1.868287909493   -1.843984903643    0.424309557605
C         -1.351356371302    0.423436030169   -0.105031584475
H         -2.380997584282    0.727930951078   -0.178696407684
C         -0.342754465714    1.295242810269   -0.307700264451
H         -0.513076887392    2.333923325289   -0.548755202735
N          0.970986870572    0.918271496119   -0.215760589663
H          1.715050890494    1.581159601239   -0.356631306554
C          1.379619808313   -0.368257769602    0.093652873430
O          2.547662715678   -0.689436029874    0.189288379272
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-42A"

p.ipnof = 5

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
