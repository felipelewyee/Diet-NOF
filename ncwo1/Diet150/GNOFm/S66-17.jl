using DoNOF

mol = """
0 1
N         -1.484427430319    1.161731424716    0.000931215377
H         -0.456005741233    1.212968263543    0.001639605380
C         -2.051252824274   -0.101463021448    0.001518903224
O         -1.348527153083   -1.114553709560    0.002650272540
C         -3.498050586926   -0.123367902478    0.000495945394
H         -4.004018749949   -1.072871370216    0.000849673396
C         -4.176448270232    1.043054591601   -0.000906022359
H         -5.255325386973    1.089747771695   -0.001728895626
N         -3.529265139882    2.244372745387   -0.001401507421
H         -4.038266364326    3.112841189648   -0.002469175438
C         -2.145906960325    2.375983577464   -0.000508814508
O         -1.594272008871    3.455999078294   -0.000984683499
N          3.389401166778    0.053259979335    0.000515843516
H          3.836644949885    0.959833179716    0.000902659385
C          4.245448936763   -1.061357810520   -0.000984033669
O          5.454900959732   -0.909653395462   -0.001733232763
C          3.531230506776   -2.323531348410   -0.001488427430
H          4.097815055760   -3.238562098235   -0.002627062349
C          2.181061531007   -2.327349220438   -0.000528331623
H          1.604098293737   -3.240313986613   -0.000847008512
N          1.443070121113   -1.176468381630    0.000922080190
H          0.416733860826   -1.197911180324    0.001599149250
C          2.015841059056    0.068196659649    0.001472727218
O          1.365520174856    1.109414964287    0.002709120225
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-17"

p.ipnof = 8
p.ista = 1
p.h_cut = 0.02 * sqrt(2)

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
