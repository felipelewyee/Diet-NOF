using DoNOF

mol = """
0 1
N          1.667600991327    0.151919878941   -2.052050083933
C          1.064479443143   -1.005789596911   -1.751042633712
H          1.708758456163   -1.874810484227   -1.693223570762
C         -0.303038572680   -1.131448391996   -1.514608338868
H         -0.723305227749   -2.094366383918   -1.262005131093
C         -1.100685707568    0.003928512778   -1.600171444745
H         -2.165570100954   -0.053090629915   -1.422125972702
C         -0.492008748677    1.214783107874   -1.915674209175
H         -1.066692692006    2.126870747942   -1.996031341779
C          0.883666874163    1.237076391774   -2.127809295969
H          1.383551558386    2.166165081817   -2.374095665186
N         -0.438603726726   -1.618490905913    2.048574941117
C         -1.371081819800   -0.657861451071    2.122426098748
H         -2.373871066804   -0.988816249895    2.364618964971
C         -1.109078782056    0.693206973035    1.913046717822
H         -1.907636538911    1.417712407645    1.991317810958
C          0.190348550964    1.082448256014    1.602778309087
H          0.432333109208    2.121446737767    1.426907053846
C          1.169907859224    0.099550100730    1.519416845151
H          2.192209098012    0.346295845540    1.270979865201
C          0.807428139167   -1.225587657106    1.752609838860
H          1.551288904225   -2.011142291221    1.696161241794
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-25"

p.ipnof = 8

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
