using DoNOF

mol = """
0 1
N          0.199781055883   -1.008275752165   -1.846381712981
H          0.454448996861   -1.960339440286   -1.620460185649
C         -1.174997731115   -0.737270903531   -1.910744643700
O         -1.989594779991   -1.619851765219   -1.703327471590
C         -1.472663241800    0.647569168593   -2.232668613670
H         -2.502304454780    0.952064089502   -2.306333436880
C         -0.464061336212    1.519375948693   -2.435337293647
H         -0.634383757890    2.558056463713   -2.676392231931
N          0.849680000074    1.142404634544   -2.343397618859
H          1.593744019996    1.805292739663   -2.484268335749
C          1.258312937815   -0.144124631178   -2.033984155766
O          2.426355845180   -0.465302891449   -1.938348649923
C          1.060774604804   -1.027096813091    1.728515535119
H          1.514627113759   -1.119153052398    0.740532981330
H          1.605277104745   -1.691077080255    2.397713207372
C          1.115088075920    0.438855188368    2.161451516916
H          2.073378066722    0.911754122668    1.950727228309
H          0.926972790002    0.520492730414    3.234674649400
C         -0.052263506826    1.051669665629    1.390680316030
H          0.222040768779    1.140451268808    0.337208694182
H         -0.336677930778    2.042810790571    1.742314330358
C         -1.169207999135    0.014097756836    1.561708629994
H         -1.894747277810    0.037711610498    0.750336718006
H         -1.713293629115    0.218794912379    2.483957246362
C         -0.446171654231   -1.352450074416    1.665365517284
H         -0.688836199948   -1.996606199248    0.822005842887
H         -0.761277880749   -1.879852488332    2.564451937005
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-42"

p.ipnof = 8

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
