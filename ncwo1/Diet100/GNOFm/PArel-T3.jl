using DoNOF

mol = """
1 1
N    -0.4070455    1.5374147    0.0000000 
N     1.5730851    0.4189613    0.0000000 
C    -0.4933066   -0.8535897    0.0000000 
C     0.9718402   -0.8800021    0.0000000 
C    -1.1115784    0.3313139    0.0000000 
C     0.9153720    1.5626318    0.0000000 
C    -1.2073060   -2.1604088    0.0000000 
O     1.6685721   -1.8430528    0.0000000 
O     1.6285879    2.6442530    0.0000000 
H    -0.9359663    2.3996266    0.0000000 
H     2.5911017    0.4423864    0.0000000 
H    -2.1873117    0.4397847    0.0000000 
H    -0.9340607   -2.7485391   -0.8769635 
H    -0.9340607   -2.7485391    0.8769635 
H    -2.2872943   -2.0249759    0.0000000 
H     1.1493711    3.4827351    0.0000000 
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "PArel-T3"

p.ipnof = 8
p.ista = 1
p.h_cut = 0.02 * sqrt(2)

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
