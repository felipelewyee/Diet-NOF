using DoNOF

mol = """
0 1
 C                  0.54981900    1.46912900    0.00000000
 N                  0.01880600    0.04592300    0.00000000
 H                  0.08335700    1.92801200    0.88308600
 H                  0.08335700    1.92801200   -0.88308600
 C                  0.54981900   -0.63341000    1.20287500
 H                  0.22431300   -1.67427700    1.21567700
 H                  1.63124900   -0.55012900    1.17062200
 H                  0.17428200   -0.10884000    2.07776000
 C                  0.54981900   -0.63341000   -1.20287500
 H                  0.22431300   -1.67427700   -1.21567700
 H                  0.17428200   -0.10884000   -2.07776000
 H                  1.63124900   -0.55012900   -1.17062200
 C                 -1.46685500   -0.07623100    0.00000000
 H                 -1.77558600   -1.12478200    0.00000000
 H                 -1.83903800    0.42866000    0.88681400
 H                 -1.83903800    0.42866000   -0.88681400
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "YBDE18-nme3-ch2"

p.ipnof = 8
p.ista = 1

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
